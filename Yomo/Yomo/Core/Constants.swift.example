//
//  Constants.swift
//  Yomo
//
//  Created by Claude on 2026-02-08.
//

import Foundation

enum Constants {
    // MARK: - App Configuration
    static let bundleId = "com.binye.Yomo"
    static let appGroupId = "group.com.binye.Yomo"
    static let notificationCategoryId = "YOMO_REMINDER"

    // MARK: - Firebase
    static let firebaseProjectId = "yomo-6340e"

    // MARK: - RevenueCat (fallback keys if build settings are not configured)
    // Build setting priority:
    // - Debug:   REVENUECAT_TEST_STORE_API_KEY
    // - Release: REVENUECAT_IOS_API_KEY
    //
    // The app reads REVENUECAT_API_KEY from Info.plist first and falls back to this value.
    #if DEBUG
    static let revenueCatAPIKey = "" // Test Store key for local debug
    #else
    static let revenueCatAPIKey = "" // iOS App Store key for TestFlight/Release
    #endif

    // MARK: - AI Services
    // Local-only runtime keys:
    // set OPENROUTER_API_KEY / CLAUDE_API_KEY / OPENAI_API_KEY
    // via Xcode user-defined build settings (do not commit).
    static var openRouterAPIKey: String {
        resolvedSecret(forInfoPlistKey: "OPENROUTER_API_KEY")
    }
    static var claudeAPIKey: String {
        resolvedSecret(forInfoPlistKey: "CLAUDE_API_KEY")
    }
    static var openaiAPIKey: String {
        resolvedSecret(forInfoPlistKey: "OPENAI_API_KEY")
    }

    // MARK: - Notification Limits
    static let maxPendingNotifications = 64

    // MARK: - Pro Features
    enum ProFeatures {
        static let customRecurrence = true
        static let customSnooze = false // Free feature
        static let aiParsing = false // Free feature with limits
    }

    private static func resolvedSecret(forInfoPlistKey key: String) -> String {
        guard let raw = Bundle.main.object(forInfoDictionaryKey: key) as? String else {
            return ""
        }

        let trimmed = raw.trimmingCharacters(in: .whitespacesAndNewlines)
        if trimmed.isEmpty || trimmed.hasPrefix("$(") {
            return ""
        }
        return trimmed
    }
}
